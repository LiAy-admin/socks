# Socks 代理管理工具使用说明

## 脚本说明

这是一个用于 Ubuntu/Debian 系统的 Socks 代理管理工具，主要用于帮助用户在中国大陆访问开源社区（如 GitHub、GitLab、Docker Hub 等）。

### 主要特性：
- 一键配置系统级代理
- 支持 HTTP/HTTPS 协议
- 支持带认证和无认证的代理服务器
- 自动配置 APT 软件包管理器代理
- 多站点连接测试
- 多源下载速度测试
- 配置持久化保存
- 支持一键卸载

### 适用场景：
- 开发者需要访问 GitHub、GitLab 等代码托管平台
- 需要下载开源软件包和依赖
- 使用 Docker、NPM、PyPI 等包管理工具
- 访问开发者社区和文档网站

### 环境要求：
- 操作系统：Ubuntu/Debian
- 权限要求：需要 root 权限
- 依赖工具：curl、wget（脚本会自动安装）

## 安装方法

1. 下载安装脚本：
```bash
git clone https://github.com/yourusername/socks.git
cd socks
```

2. 运行安装脚本：
```bash
sudo bash install.sh
```

## 配置方法

### 1. 初始配置

安装完成后，系统会自动创建配置文件：`/etc/socks/config.conf`

您可以通过以下两种方式配置代理：

1. 通过交互式菜单配置：
```bash
socks
# 选择选项 6 "配置代理"
```

2. 直接编辑配置文件：
```bash
sudo nano /etc/socks/config.conf
```

### 2. 配置示例

a. 不需要账号密码的代理服务器：
```bash
# 示例1：本地代理服务器
PROXY_HOST="127.0.0.1"           # 代理服务器地址
PROXY_PORT="1080"                # 代理服务器端口
PROXY_PROTOCOL="http"            # 代理协议（http/https）
PROXY_AUTH="false"               # 是否启用认证（false表示不需要认证）
PROXY_USER=""                    # 无需填写
PROXY_PASS=""                    # 无需填写
```

b. 需要账号密码的代理服务器：
```bash
# 示例2：带认证的代理服务器
PROXY_HOST="proxy.example.com"   # 代理服务器地址
PROXY_PORT="8080"                # 代理服务器端口
PROXY_PROTOCOL="http"            # 代理协议（http/https）
PROXY_AUTH="true"                # 是否启用认证（true表示需要认证）
PROXY_USER="username"            # 您的代理账号
PROXY_PASS="password"            # 您的代理密码
```

### 3. 日常使用

1. 启动代理：
```bash
socks  # 进入交互式菜单
# 或直接使用命令：
proxy_on
```

2. 关闭代理：
```bash
proxy_off
```

3. 查看代理状态：
```bash
socks  # 进入交互式菜单，选择选项 3
```

4. 测试代理连接：
```bash
socks  # 进入交互式菜单，选择选项 4
```

5. 测试下载速度：
```bash
socks  # 进入交互式菜单，选择选项 5
```

### 4. 配置说明

1. 系统配置文件位置：
   - 主配置文件：`/etc/socks/config.conf`
   - 环境变量配置：由脚本自动管理
   - APT代理配置：由脚本自动管理

2. 自动生成的配置：
   - 系统环境变量
   - APT软件包管理器代理设置
   - Shell配置（proxy_on/proxy_off命令）

3. 配置生效说明：
   - 所有配置修改后立即生效
   - 重启系统后配置仍然保持
   - 卸载时所有配置会被清理

## 功能说明

### 1. 交互式菜单

在终端中输入以下命令启动交互式管理菜单：
```bash
socks
```

菜单选项说明：
1. 启动代理：配置并启用系统代理
2. 禁用代理：关闭并清除代理设置
3. 代理状态：显示当前代理配置信息
4. 测试代理：检查与 GitHub/GitLab 的连接状态
5. 网速测试：测试代理下载速度和网络延迟
6. 卸载代理：完全移除代理配置
0. 退出：退出管理菜单

### 2. 命令行快捷方式

除了使用交互式菜单，您还可以直接使用以下命令：
- `proxy_on`: 快速启用代理
- `proxy_off`: 快速禁用代理

### 3. 注意事项

1. 权限要求：
   - 安装和配置需要 root 权限
   - 建议使用 sudo 运行相关命令

2. 配置文件：
   - 环境变量配置：/etc/environment
   - APT 代理配置：/etc/apt/apt.conf.d/proxy.conf
   - 用户配置：~/.bashrc

3. 故障排查：
   - 如果代理无法连接，使用"测试代理"功能检查
   - 定期使用"网速测试"监控代理性能
   - 如遇问题可以查看备份文件恢复配置

4. 安全建议：
   - 定期更新系统和代理配置
   - 不使用时建议关闭代理
   - 重要操作前先测试代理状态

### 4. 备份和恢复

- 安装时会自动备份原有配置
- 备份文件位于原文件位置，带有时间戳
- 可以通过复制备份文件恢复原配置

### 5. 卸载方法

1. 使用菜单卸载：
   - 运行 `socks` 命令
   - 选择选项 6 "卸载代理"

2. 手动卸载：
   - 禁用代理（proxy_off）
   - 删除配置文件
   - 恢复备份文件（如需要）

## 常见问题

1. Q: 代理设置后无法生效？
   A: 尝试重新启动终端或运行 `source ~/.bashrc`

2. Q: 如何确认代理是否工作？
   A: 使用菜单中的"测试代理"功能或访问 GitHub 等网站

3. Q: 系统重启后需要重新设置吗？
   A: 不需要，配置会自动持久化保存

4. Q: 如何切换不同的代理服务器？
   A: 目前需要修改安装脚本中的代理服务器地址

5. Q: 为什么不同站点的下载速度差异很大？
   A: 这是正常现象，受多种因素影响：
      - 服务器地理位置不同
      - 网络路由不同
      - 服务器负载不同
      - 文件大小不同

6. Q: 如何选择最适合的下载源？
   A: 使用"网速测试"功能测试各个站点，选择速度最快的作为主要下载源

## 技术支持

如有问题或建议，请通过以下方式反馈：
1. 提交 GitHub Issue
2. 发送邮件至维护者
3. 在项目讨论区留言

## 更新日志

### v1.0.0 (2023-12-10)
- 初始版本发布
- 支持基本的代理管理功能
- 添加网速测试功能
- 实现配置持久化